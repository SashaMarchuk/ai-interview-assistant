---
phase: 14-linter-prettier
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - wxt.config.ts
  - eslint.config.mjs
  - .prettierrc.json
  - .prettierignore
  - .claude/settings.json
autonomous: true

must_haves:
  truths:
    - "`npx eslint .` runs with zero errors across the entire codebase"
    - "`npx prettier --check .` reports all files are formatted"
    - "Claude Code hook auto-runs `eslint --fix` and `prettier --write` after every file Edit/Write"
    - "ESLint config covers TypeScript recommended rules for Chrome extension + React project"
  artifacts:
    - path: "eslint.config.mjs"
      provides: "ESLint 10 flat config with typescript-eslint, react-hooks, globals, WXT auto-imports, prettier override"
      contains: "defineConfig"
    - path: ".prettierrc.json"
      provides: "Prettier config with Tailwind v4 class sorting"
      contains: "tailwindStylesheet"
    - path: ".prettierignore"
      provides: "Prettier ignore list for generated/vendor files"
      contains: ".output"
    - path: ".claude/settings.json"
      provides: "PostToolUse hook for auto-formatting on Edit/Write"
      contains: "PostToolUse"
  key_links:
    - from: "eslint.config.mjs"
      to: ".wxt/eslint-auto-imports.mjs"
      via: "import statement"
      pattern: "import.*eslint-auto-imports"
    - from: "wxt.config.ts"
      to: ".wxt/eslint-auto-imports.mjs"
      via: "eslintrc.enabled: 9 config generates the file"
      pattern: "eslintrc.*enabled.*9"
    - from: "eslint.config.mjs"
      to: "eslint-config-prettier"
      via: "LAST entry in config array to disable conflicting rules"
      pattern: "eslintConfigPrettier"
    - from: ".claude/settings.json"
      to: "prettier + eslint"
      via: "PostToolUse hook runs both tools on edited files"
      pattern: "PostToolUse"
---

<objective>
Install and configure ESLint 10 + Prettier for the entire codebase, format all files, fix all lint errors, and wire a Claude Code auto-format hook.

Purpose: Enforce consistent code formatting and lint rules automatically during development and Claude Code sessions (DX-01).
Output: Zero-error lint + fully formatted codebase + auto-format hook.
</objective>

<execution_context>
@/Users/sasha-marchuk/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sasha-marchuk/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/14-linter-prettier/14-RESEARCH.md

@package.json
@wxt.config.ts
@tsconfig.json
@src/assets/app.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install packages and create all configuration files</name>
  <files>
    package.json
    wxt.config.ts
    eslint.config.mjs
    .prettierrc.json
    .prettierignore
  </files>
  <action>
1. Install all dev dependencies:
   ```bash
   npm install -D eslint @eslint/js typescript-eslint globals eslint-config-prettier eslint-plugin-react-hooks prettier prettier-plugin-tailwindcss
   ```

2. Add `imports.eslintrc.enabled: 9` to `wxt.config.ts` so WXT generates `.wxt/eslint-auto-imports.mjs`:
   ```typescript
   export default defineConfig({
     modules: ['@wxt-dev/module-react'],
     imports: {
       eslintrc: {
         enabled: 9,
       },
     },
     // ... rest unchanged
   });
   ```

3. Run `npx wxt prepare` to generate `.wxt/eslint-auto-imports.mjs`.

4. Create `eslint.config.mjs` (ESLint 10 flat config):
   ```javascript
   // @ts-check
   import eslint from '@eslint/js';
   import { defineConfig } from 'eslint/config';
   import tseslint from 'typescript-eslint';
   import eslintConfigPrettier from 'eslint-config-prettier/flat';
   import reactHooks from 'eslint-plugin-react-hooks';
   import globals from 'globals';
   import autoImports from './.wxt/eslint-auto-imports.mjs';

   export default defineConfig(
     { ignores: ['.output/**', '.wxt/**', 'node_modules/**', 'public/**', '.planning/**', 'scripts/**'] },
     eslint.configs.recommended,
     tseslint.configs.recommended,
     {
       languageOptions: {
         globals: {
           ...globals.browser,
           ...globals.webextensions,
         },
       },
     },
     autoImports,
     reactHooks.configs.flat.recommended,
     eslintConfigPrettier,
   );
   ```
   **Important:** `eslintConfigPrettier` MUST be last. `autoImports` provides WXT auto-import globals to suppress false `no-undef` errors. Use `eslint-config-prettier/flat` import path (not default).

5. Create `.prettierrc.json`:
   ```json
   {
     "singleQuote": true,
     "trailingComma": "all",
     "printWidth": 100,
     "tabWidth": 2,
     "semi": true,
     "arrowParens": "always",
     "endOfLine": "lf",
     "plugins": ["prettier-plugin-tailwindcss"],
     "tailwindStylesheet": "./src/assets/app.css"
   }
   ```
   **Important:** `tailwindStylesheet` is required for Tailwind v4 -- without it, the plugin uses the default theme and may sort classes incorrectly.

6. Create `.prettierignore`:
   ```
   node_modules/
   .output/
   .wxt/
   .planning/
   package-lock.json
   *.md
   ```

7. Add lint/format scripts to `package.json`:
   ```json
   "lint": "eslint .",
   "lint:fix": "eslint . --fix",
   "format": "prettier --write \"src/**/*.{ts,tsx,css}\" \"entrypoints/**/*.{ts,tsx}\" \"*.{json,mjs,ts}\"",
   "format:check": "prettier --check \"src/**/*.{ts,tsx,css}\" \"entrypoints/**/*.{ts,tsx}\" \"*.{json,mjs,ts}\""
   ```
  </action>
  <verify>
    - `ls eslint.config.mjs .prettierrc.json .prettierignore` shows all 3 config files exist
    - `cat wxt.config.ts | grep 'eslintrc'` confirms WXT ESLint integration enabled
    - `ls .wxt/eslint-auto-imports.mjs` confirms auto-import globals file was generated
    - `cat package.json | grep '"lint"'` confirms npm scripts added
    - `npx eslint --print-config entrypoints/background.ts | head -5` confirms ESLint config loads without error
  </verify>
  <done>All ESLint + Prettier packages installed, config files created, WXT auto-import ESLint integration enabled, npm scripts added.</done>
</task>

<task type="auto">
  <name>Task 2: Format codebase, fix all lint errors, and create Claude Code hook</name>
  <files>
    .claude/settings.json
    (all .ts/.tsx/.css/.json/.mjs files -- formatting changes)
  </files>
  <action>
1. Run Prettier on the entire codebase to format all files:
   ```bash
   npx prettier --write "src/**/*.{ts,tsx,css}" "entrypoints/**/*.{ts,tsx}" "*.{json,mjs,ts}"
   ```

2. Run ESLint with auto-fix on the entire codebase:
   ```bash
   npx eslint . --fix
   ```

3. If any ESLint errors remain after --fix, manually fix them. Common expected issues:
   - `@typescript-eslint/no-unused-vars` -- remove unused imports/variables
   - `@typescript-eslint/no-explicit-any` -- add proper types where feasible, or add `// eslint-disable-next-line` with justification for the ONE known `as any` in `wxt.config.ts` (Tailwind plugin type cast, already documented)
   - `no-undef` for WXT auto-imports -- should be handled by `autoImports` config; if not, check `.wxt/eslint-auto-imports.mjs` was generated correctly

4. Run both checks to confirm zero errors:
   ```bash
   npx eslint .
   npx prettier --check "src/**/*.{ts,tsx,css}" "entrypoints/**/*.{ts,tsx}" "*.{json,mjs,ts}"
   ```

5. Create `.claude/settings.json` with PostToolUse hook for auto-formatting:
   ```json
   {
     "hooks": {
       "PostToolUse": [
         {
           "matcher": "Edit|Write",
           "hooks": [
             {
               "type": "command",
               "command": "jq -r '.tool_input.file_path' | xargs -I{} sh -c 'npx prettier --write \"{}\" 2>/dev/null; npx eslint --fix \"{}\" 2>/dev/null; exit 0'"
             }
           ]
         }
       ]
     }
   }
   ```
   **Important:** The hook receives JSON on stdin with `tool_input.file_path`. Use `jq` to extract. Always `exit 0` to avoid blocking Claude's workflow. Prettier runs first (fast), then eslint --fix (slower).

6. Verify the hook file is valid JSON:
   ```bash
   cat .claude/settings.json | jq .
   ```
  </action>
  <verify>
    - `npx eslint .` exits with code 0 (zero errors)
    - `npx prettier --check "src/**/*.{ts,tsx,css}" "entrypoints/**/*.{ts,tsx}" "*.{json,mjs,ts}"` exits with code 0
    - `cat .claude/settings.json | jq '.hooks.PostToolUse[0].matcher'` outputs `"Edit|Write"`
    - `npx wxt build` completes without errors (formatting changes didn't break build)
  </verify>
  <done>Entire codebase formatted by Prettier, all ESLint errors resolved, Claude Code PostToolUse hook created. `npx eslint .` and `npx prettier --check .` both report clean.</done>
</task>

</tasks>

<verification>
1. `npx eslint .` -- zero errors, zero warnings (or only expected informational warnings)
2. `npx prettier --check "src/**/*.{ts,tsx,css}" "entrypoints/**/*.{ts,tsx}" "*.{json,mjs,ts}"` -- all files formatted
3. `cat .claude/settings.json` -- PostToolUse hook with Edit|Write matcher exists
4. `npx wxt build` -- build succeeds (no regressions from formatting/lint fixes)
5. ESLint config includes: typescript-eslint recommended, react-hooks, browser+webextensions globals, WXT auto-imports, prettier override
</verification>

<success_criteria>
- `npx eslint .` exits clean across all 57+ TS/TSX files
- `npx prettier --check .` reports all files formatted
- `.claude/settings.json` contains PostToolUse hook for Edit|Write
- `eslint.config.mjs` uses ESLint 10 defineConfig with typescript-eslint, react-hooks, globals, auto-imports, prettier
- `npx wxt build` still succeeds
</success_criteria>

<output>
After completion, create `.planning/phases/14-linter-prettier/14-01-SUMMARY.md`
</output>
